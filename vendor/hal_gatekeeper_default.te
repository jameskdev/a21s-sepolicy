# hal_gatekeeper_default.te

tzdaemon_use(hal_gatekeeper_default)

get_prop(hal_gatekeeper_default, tztsdaemon_prop)
get_prop(hal_gatekeeper_default, vendor_tztsdaemon_prop)
set_prop(hal_gatekeeper_default, dumpstate_options_prop)

allow hal_gatekeeper_default hal_gatekeeper_default_exec:file { read getattr map execute open entrypoint };

allow hal_gatekeeper_default apk_data_file:file { read write };
allow hal_gatekeeper_default efs_file:dir rw_dir_perms;
allow hal_gatekeeper_default efs_file:file create_file_perms;
allow hal_gatekeeper_default hermes_socket:sock_file write;
allow hal_gatekeeper_default mnt_vendor_file:dir search;
allow hal_gatekeeper_default mobicore_file:dir r_dir_perms;
allow hal_gatekeeper_default mobicore_file:file r_file_perms;
allow hal_gatekeeper_default mobicore_user_device:chr_file { ioctl read write open };
allow hal_gatekeeper_default persist_file:dir { search };
allow hal_gatekeeper_default prov_efs_file:dir create_dir_perms;
allow hal_gatekeeper_default prov_efs_file:file create_file_perms;
allow hal_gatekeeper_default sec_debugfs:dir r_dir_perms;
allow hal_gatekeeper_default sec_poc_file:dir rw_dir_perms;
allow hal_gatekeeper_default sec_poc_file:file create_file_perms;
allow hal_gatekeeper_default tz_device:chr_file rw_file_perms;
allow hal_gatekeeper_default vendor_data_file:dir search;
allow hal_gatekeeper_default vendor_gatekeeper_data_file:dir r_dir_perms;
allow hal_gatekeeper_default vendor_gk_data_file:dir { write add_name search };
allow hal_gatekeeper_default vendor_gk_data_file:file create_file_perms;
